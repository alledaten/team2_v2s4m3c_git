<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dev.mvc.review_cate.Review_CateDAOInter">

  <!-- review_cate 등록 -->
  <insert id="create" parameterType="Review_CateVO">
    INSERT INTO review_cate(review_cate_no, review_categrp_no, review_cate_name, review_cate_seqno, review_cate_date, review_cate_cnt)
    VALUES(review_cate_seq.nextval, #{review_categrp_no}, #{review_cate_name}, #{review_cate_seqno}, sysdate, 0)
  </insert> 
  
  <!-- review_categrp + review_cate join 목록 -->
  <select id="list_join" resultType="Review_Categrp_Review_Cate_join">
    SELECT g.review_categrp_no as g_review_categrp_no, g.review_categrp_name as g_review_categrp_name, 
          c.review_cate_no, c.review_categrp_no, c.review_cate_name, c.review_cate_seqno, c.review_cate_date, c.review_cate_cnt
    FROM review_categrp g, review_cate c
    WHERE g.review_categrp_no = c.review_categrp_no
    ORDER BY g.review_categrp_no ASC, c.review_cate_seqno ASC
  </select>
  
  <!-- Categrpno 별 Cate 목록 (Review_Categrp + Review_Cate의 join)-->
 <select id="list_join_by_review_categrp_no" resultType="Review_Categrp_Review_Cate_join" parameterType="int">
  SELECT g.review_categrp_no as g_review_categrp_no, g.review_categrp_name as g_review_categrp_name,
            c.review_cate_no, c.review_categrp_no, c.review_cate_name, c.review_cate_seqno, c.review_cate_date, c.review_cate_cnt
  FROM  review_categrp g, review_cate c
  WHERE (g.review_categrp_no = c.review_categrp_no) AND g.review_categrp_no= #{review_categrp_no}
  ORDER BY g.review_categrp_no ASC, c.review_cate_seqno ASC
 </select>
 
 <!-- 조회 -->
  <select id="read" resultType="Review_CateVO" parameterType="int">
    SELECT review_cate_no, review_categrp_no, review_cate_name, review_cate_seqno, review_cate_date, review_cate_cnt
    FROM review_cate
    WHERE review_cate_no = #{review_cate_no}
  </select>  
  
  <!-- 수정 -->
  <update id="update" parameterType="Review_CateVO">
    UPDATE review_cate
    SET review_categrp_no=#{review_categrp_no}, review_cate_name=#{review_cate_name}, review_cate_seqno=#{review_cate_seqno}, review_cate_cnt=#{review_cate_cnt}
    WHERE review_cate_no = #{review_cate_no}
  </update>
  
  <!-- 삭제, return: int -->
  <delete id="delete" parameterType="int">
    DELETE review_cate
    WHERE review_cate_no = #{review_cate_no}
  </delete>
  
  <!-- 우선순위 상향 up 10 ▷ 1 -->
  <update id="update_review_cate_seqno_up" parameterType="int">
    UPDATE review_cate
    SET review_cate_seqno = review_cate_seqno - 1
    WHERE review_cate_no = #{review_cate_no}
  </update>
  
  <!-- 우선순위 하향 down 1 ▷ 10 -->
  <update id="update_review_cate_seqno_down" parameterType="int">
    UPDATE review_cate
    SET review_cate_seqno = review_cate_seqno + 1
    WHERE review_cate_no = #{review_cate_no}
  </update>
  
  <update id="increaseCnt" parameterType="int">
    UPDATE  review_cate
    SET review_cate_cnt = review_cate_cnt + 1 
    WHERE review_cate_no= #{review_cate_no}
  </update>

  <update id="decreaseCnt" parameterType="int">
    UPDATE review_cate 
    SET review_cate_cnt = review_cate_cnt - 1 
    WHERE review_cate_no=#{review_cate_no}
  </update>
 

</mapper>